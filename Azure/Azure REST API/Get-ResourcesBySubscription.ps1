# Author: Xtormin (Jennifer Torres)
# Github: https://github.com/xtormin

param (
    [Parameter(Mandatory=$true)]
    [string]$Token,
    [Parameter(Mandatory=$true)]
    [string]$SubscriptionID
)

# Request parameters
$RequestParams = @{
    Method  = 'GET'
    Uri     = 'https://management.azure.com/subscriptions/' + $SubscriptionID + '/resources?api-version=2020-10-01'
    Headers = @{ 'Authorization' = "Bearer $Token" }
}

# Make the request and output the result
try {
    $response = Invoke-RestMethod @RequestParams
    $response.value
} catch {
    Write-Error "An error occurred: $_"
}


# Example usage:
# .\Get-ResourcesBySubscriptions.ps1 -Token '<TOKEN JWT>' -SubscriptionID 'b413226f-108d-4049-8c41-d52d7d388768'
