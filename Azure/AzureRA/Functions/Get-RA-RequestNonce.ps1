# Author: Xtormin (Jennifer Torres)
# Github: https://github.com/xtormin

function Get-RA-RequestNonce{
    param (
        [Parameter(Mandatory=$true)]
        [string]$TenantID
    )

    # Request parameters
    $Params = @{
        Method  = 'POST'
        Uri     = 'https://login.microsoftonline.com/' + $TenantId + '/oauth2/token'
    }

    $Body = @{
        "grant_type" = "srv_challenge"
    }

    # Make the request and output the result
    try {
        $response = Invoke-RestMethod @Params -UseBasicParsing -Body $Body
        return $response.Nonce
    } catch {
        Write-Error "An error occurred: $_"
    }
}

# Example usage:
# Get-RA-RequestNonce -TenantID '<Tenant ID>'