# PowerPentest - Azure

## azure_email_validator.ps1

This script validates a list of email addresses by checking their existence in Office 365 without submitting login attempts. 

It takes a file containing a list of email addresses as input and validates each email address by making a REST request to Office 365. It checks whether the email address exists in Office 365 without actually attempting to log in. The result, along with the email address, is then outputted. Additionally, the script supports filtering the output to only show email addresses that exist.

```powershell
.\azure_email_validator.ps1 -file emails.txt -output emails_validated.txt
```

Manual request for validate an email in Azure:

```commandline
POST /common/GetCredentialType HTTP/1.1
Host: login.microsoftonline.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:123.0) Gecko/20100101 Firefox/123.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: es-ES,es;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Te: trailers
Connection: close
Content-Length: 76
Content-Type: application/json

{
"username":"xtormin@xtormin.com",
"isOtherIdpSupported":  true
}
```