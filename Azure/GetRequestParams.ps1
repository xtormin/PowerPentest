# Author: Xtormin (Jennifer Torres)
# Github: https://github.com/xtormin
# Description: This script takes a token and URI as parameters and makes a GET request to the specified URI using the provided token.

# Import: . .\GetRequestParams.ps1

function Invoke-GetRequestParams {
    <#
    .SYNOPSIS
    Makes a GET request to a specified URI using a provided Bearer token.

    .DESCRIPTION
    This function takes a Bearer token and a URI as input parameters and performs a GET request to the given URI. The response is displayed in the console.

    .PARAMETER Token
    The Bearer token used for authorization.

    .PARAMETER URI
    The URI to which the GET request is made.

    .EXAMPLE
    PS> Invoke-GetRequestParams -Token '<token JWT>' -URI '<URI>'

    .NOTES
    Author: Xtormin (Jennifer Torres)
    Github: https://github.com/xtormin
    Twitter: https://twitter.com/xtormin
    Linkedin: https://www.linkedin.com/in/xtormin/
    #>

    param (
        [Parameter(Mandatory=$true)]
        [string]$Token,
        
        [Parameter(Mandatory=$true)]
        [string]$URI
    )

    # Request parameters
    $RequestParams = @{
        Method  = 'GET'
        Uri     = $URI
        Headers = @{ 'Authorization' = "Bearer $Token" }
    }

    # Make the request and output the result
    try {
        $response = Invoke-RestMethod @RequestParams
        $response.value
    } catch {
        Write-Error "An error occurred: $_"
    }
}

# Example usage:
# Invoke-GetRequestParams -Token '<TOKEN JWT>' -URI 'https://management.azure.com/subscriptions?api-version=2020-01-01'